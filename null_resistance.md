# ミラー補償で「逆向きに流れる」と感じる理由  
## ― なぜ直列抵抗 Rz があると性格が変わるのか ―

## 概要

2段CMOSオペアンプのミラー補償を学ぶと、必ず出てくる疑問がある。

> 入力が先に変わるのに、  
> なぜ Cc の電流は「逆向き」に効くのか？  
>  
> なぜ Cc に直列抵抗 Rz を入れるだけで、  
> RHP零点が LHP零点になるのか？

本記事では、この疑問を  
**電流の向きではなく「因果関係」と「主導権」**の観点から整理する。

---

## 1. 結論を先に

**重要な結論はこれである。**

> 抵抗なしのミラー補償では、  
> 出力は「前に進もうとしてから戻される」のではなく、  
> **最初から前に進む自由を与えられていない。**

つまり問題は  
- 電流が逆向きに流れるかどうか  
ではなく  
- **出力が支配されているかどうか**

である。

---

## 2. 回路と前提

対象は以下の構成である。

- 第2段：NMOS 共通ソース増幅器
- 出力ノード：out
- 補償容量：Cc（n1–out 間）
- 負荷容量：CL（out–GND）
- オプション：Cc 直列抵抗 Rz

---

## 3. よくある直感（半分正しい）

多くの人はこう考える。

> 入力 n1 が先に上がる  
> → Cc の電流は n1 → out に流れる  
> → 出力を助けるはず

これは **電流の向きだけ見れば正しい**。

しかし、実際の問題は  
**「その電流が出力ノードで何をしているか」**  
にある。

---

## 4. 時間順で見る（抵抗なし）

### t = 0⁺（無限に小さい時間）

1. 入力 n1 が上昇する
2. 出力 out は CL のため **まだ動けない**
3. Cc は「差を消せ」と即座に反応する

Cc の目的はただ一つ：

> **n1 と out の電圧差を今すぐゼロにする**

このとき重要なのは：

- out が「高い」から戻されるのではない
- **out が動けない（慣性がある）から拘束される**

---

## 5. 出力ノードで起きていること（KCL視点）

出力ノードには同時に2つの作用がある。

### (1) gm2 の電流
- 入力電圧を電流に変換
- 出力を「動かそう」とする
- 有限の強さ（gm2）

### (2) Cc の電流
- 電圧差の時間変化に反応
- 「差を作るな」という拘束
- 微分なので即効性がある

この **即効性のある拘束**が gm2 より先に効く。

結果として：

> gm2 が作った電流は  
> 出力電圧を変える仕事をせず、  
> Cc 経由で入力側に逃げたように見える。

これが  
**「逆向きに流れたように見える」正体**である。

---

## 6. 重要な修正点（誤解の否定）

❌ 間違った理解  
- 出力が一度前に進んでから戻される  
- 電圧が高いから押し返される  

✅ 正しい理解  
- **最初から前に進めていない**
- **出力は拘束条件に縛られている**

RHP零点とは  
「逆初動」ではなく  
**「前進できない因果構造」**である。

---

## 7. 直列抵抗 Rz を入れると何が変わるか

Rz を入れると、Cc 電流は：

- 即座に出力を拘束できない
- まず入力側に電圧変化を作る
- gm2 が主導権を持つ

つまり：

- 出力は **gm2 によって先に動く**
- Cc は「後から整える役」に回る

この結果、零点は **LHP側**に現れる。

---

## 8. なぜ Rz ≈ 1/gm2 が境界なのか

高周波では Cc はほぼ短絡とみなせる。

このとき出力ノードでは：

- gm2 の強さ：gm2
- Cc+Rz 経路の強さ：1/Rz

### 比較すると：

- Rz ≪ 1/gm2  
  → Cc拘束が勝つ → RHP零点
- Rz ≈ 1/gm2  
  → 拘束が打ち消される → 零点消失
- Rz ≫ 1/gm2  
  → gm2 が勝つ → LHP零点

**符号が変わるのではない。  
主導権が入れ替わるだけである。**

---

## 9. なぜ零極相殺が危険なのか（位相余裕）

RHP零点は：

- 振幅：+20 dB/dec
- 位相：−90°

仮に極で振幅を相殺しても：

- 位相遅れは残る
- プロセスばらつきで位置は必ずズレる

結果：

> 振幅はきれいでも  
> 位相余裕だけが確実に悪化する

これが  
**「零極相殺は危険」と言われる理由**である。

---

## 10. まとめ（最重要）

- 抵抗なしの Cc は  
  **前向き経路ではなく拘束条件**
- RHP零点とは  
  **出力が前進できない因果構造**
- Rz は  
  **拘束の即効性を壊すための部品**
- 境界は  
  **Rz ≈ 1/gm2**
- 符号が変わるのではなく  
  **支配する経路が変わる**

---

## おわりに

ここまで理解できていれば、

- ミラー補償
- RHP零点
- ヌル抵抗
- 位相余裕

はすべて **一つの因果関係**として説明できる。

これは  
**アナログ回路設計者の思考そのもの**である。
